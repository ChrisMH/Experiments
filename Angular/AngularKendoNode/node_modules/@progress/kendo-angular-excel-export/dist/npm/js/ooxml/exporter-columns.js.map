{"version":3,"sources":["webpack:///webpack/bootstrap 951fd2904c6982ee54e0?e3ae**********","webpack:///./src/ooxml/exporter-columns.ts"],"names":[],"mappings":"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","file":"src/ooxml/exporter-columns.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 951fd2904c6982ee54e0","import { CellOptions } from './cell-options.interface';\n\n/* tslint:disable align */\n\nconst compileTemplate = (templateRef: any, context: any, updateContext: (context: any, data: any) => void): any => {\n    const embeddedView = templateRef.createEmbeddedView(context);\n\n    const result = (data: any): string => {\n        updateContext(context, data);\n\n        embeddedView.detectChanges();\n\n        return embeddedView.rootNodes.reduce((content, rootNode) => {\n            return content + rootNode.textContent;\n        }, '').trim();\n    };\n\n    (result as any).destroy = (): void => {\n        embeddedView.destroy();\n    };\n\n    return result;\n};\n\nconst updateGroupHeaderContext = (context: any, data: any): void => {\n    context.$implicit = context.group = data;\n    context.field = data.field;\n    context.value = data.value;\n    context.aggregates = data.aggregates;\n};\n\nconst updateGroupFooterContext = (context: any, data: any): void => {\n    context.group = data.group;\n    context.field = data.group.field;\n    context.$implicit = context.aggregates = data;\n};\n\nconst updateFooterContext = (_context: any, _data: any): void => { }; /* tslint:disable-line no-empty */\n\n/**\n * @hidden\n */\nexport const toExporterColumns = (sourceColumns: any[]): ExporterColumn[] => {\n    const exporterColumns = [];\n    let columnIndex = 0;\n\n    const addColumns = (columns, result, level) => {\n        columns.forEach((column) => {\n            if (column.level === level) {\n                const exporterColumn = new ExporterColumn(column, columnIndex);\n                result.push(exporterColumn);\n\n                if (column.children && column.children.length > 1) {\n                    const children = exporterColumn.columns = [];\n                    addColumns(column.children, children, level + 1);\n                } else {\n                    columnIndex++;\n                }\n            }\n        });\n    };\n\n    addColumns(sourceColumns, exporterColumns, 0);\n\n    return exporterColumns;\n};\n\n/**\n * @hidden\n */\nexport const destroyColumns = (columns: ExporterColumn[]): void => {\n    if (columns) {\n        columns.forEach(column => {\n            column.destroy();\n        });\n    }\n};\n\n/**\n * @hidden\n */\nexport class ExporterColumn {\n    public title: string;\n\n    public field: string;\n\n    public hidden: boolean;\n\n    public locked: boolean;\n\n    public width: number;\n\n    public columns: ExporterColumn[];\n\n    public groupHeaderTemplate: any;\n\n    public groupFooterTemplate: any;\n\n    public footerTemplate: any;\n\n    public headerCellOptions: CellOptions;\n\n    public cellOptions: CellOptions;\n\n    public groupHeaderCellOptions: CellOptions;\n\n    public groupFooterCellOptions: CellOptions;\n\n    public footerCellOptions: CellOptions;\n\n    constructor(column: any, columnIndex?: number) {\n        this.title = column.title;\n        this.field = column.field;\n        this.hidden = column.hidden;\n        this.locked = column.locked;\n        this.width = column.width;\n\n        this.headerCellOptions = column.headerCellOptions;\n        this.cellOptions = column.cellOptions;\n        this.groupHeaderCellOptions = column.groupHeaderCellOptions;\n        this.groupFooterCellOptions = column.groupFooterCellOptions;\n        this.footerCellOptions = column.footerCellOptions;\n\n        if (column.footerTemplate) {\n            this.footerTemplate = compileTemplate(column.footerTemplate.templateRef, Object.assign({}, {\n                $implicit: column,\n                column: column,\n                columnIndex: columnIndex\n            }), updateFooterContext);\n        }\n\n        if (column.groupFooterTemplate) {\n            this.groupFooterTemplate = compileTemplate(column.groupFooterTemplate.templateRef, { column: column }, updateGroupFooterContext);\n        }\n\n        if (column.groupHeaderTemplate) {\n            this.groupHeaderTemplate = compileTemplate(column.groupHeaderTemplate.templateRef, {}, updateGroupHeaderContext);\n        }\n    }\n\n    public destroy(): void {\n        if (this.footerTemplate) {\n            this.footerTemplate.destroy();\n        }\n\n        if (this.groupFooterTemplate) {\n            this.groupFooterTemplate.destroy();\n        }\n\n        if (this.groupHeaderTemplate) {\n            this.groupHeaderTemplate.destroy();\n        }\n\n        destroyColumns(this.columns);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ooxml/exporter-columns.ts"],"sourceRoot":""}